if (self.CavalryLogger) { CavalryLogger.start_js(["U7JQt"]); }

__d("ChatSidebarHoverCardV2",["Arbiter","AsyncLoader","Hovercard","LayerHideOnBlur","TimeSlice","emptyFunction"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=null,h=null,i=new(b("AsyncLoader"))("/ajax/chat/hovercard/sidebar.php","hover"),j=5;b("Arbiter").subscribe("Hovercard/dirty",i.reset.bind(i));function k(a,c){var d=function(){i.get(a,c)};b("TimeSlice").guard(d,"superfluous request to first open DD",{propagationType:b("TimeSlice").PropagationType.ORPHAN})()}function l(a,b){if(!b||!Array.isArray(b))return[];a=b.indexOf(a);return a===-1?[]:b.slice(Math.max(0,a-j),Math.min(b.length,a+j+1)).filter(Boolean)}var m={show:function(a,c){__p&&__p();if(!a||!c)return;g=a;h&&h.hide&&h.hide();k(a,function(d){__p&&__p();var e=b("Hovercard").getDialog(d);if(!e)return;if(a===g){e.enableBehavior(b("LayerHideOnBlur")).setContext(c).setPosition("left").show();h=e;var f=e.subscribe("mouseenter",function(){m.show(a,c)}),i=e.subscribe("mouseleave",function(){f.unsubscribe(),e.hide()}),j=e.subscribe("hide",function(){f.unsubscribe(),i.unsubscribe(),j.unsubscribe(),h=null})}})},prefetchHoverCardData:function(a,c){a=l(a,c);k(a,b("emptyFunction"))}};e.exports=m}),null);